#!/bin/sh

cli_base="
	base
	bc
	ctags
	git
	htop
	lsof
	man-db
	man-pages
	openssh
	rsync
	strace
	sudo
	unzip
	usbutils
	vim
	zip
"

cli_extra="
	android-tools
	dmidecode
	iw
	ldns
	mesa-utils
	nordvpn-bin
	perf
	picocom
	trace-cmd
	vulkan-tools
	wireguard-tools
"

gui_base="
	alacritty
	brightnessctl
	cups
	fcitx5-chewing
	fcitx5-configtool
	fcitx5-gtk
	i3status
	mako
	noto-fonts
	noto-fonts-cjk
	noto-fonts-emoji
	pipewire-pulse
	sway
	swayidle
	swaylock
	xdg-desktop-portal-gtk
	xdg-desktop-portal-wlr
"

gui_extra="
	google-chrome
	grim
	gtk4
	mpv
	slurp
	swayimg
	wayland-utils
	wl-clipboard
"

dev_base="
	base-devel
	ccache
	clang
	cmake
	gdb
	meson
"

dev_mesa="
	glslang
	libclc
	llvm
	spirv-llvm-translator
"

dev_cross="
	aarch64-linux-gnu-gcc
	qemu-user-static-binfmt
"

hw_metal="
	btrfs-progs
	dosfstools
	linux
	linux-firmware-realtek
	sbctl
	systemd-ukify
	wireless-regdb
	zram-generator
"

hw_t580="
	linux-firmware-intel
	intel-ucode
	iwd
	vulkan-intel
"

hw_xps="
	bcm20702a1-firmware
	broadcom-wl-dkms
	intel-ucode
	linux-headers
	vulkan-intel
	wpa_supplicant
"

hw_crostini="
	cros-container-guest-tools-git
"

pkgs="$cli_base"

host="$(uname -n)"
case "$host" in
	"t580")
		pkgs="$pkgs $cli_extra"
		pkgs="$pkgs $gui_base $gui_extra"
		pkgs="$pkgs $dev_base $dev_mesa $dev_cross"
		pkgs="$pkgs $hw_metal $hw_t580"
		;;
	"xps")
		pkgs="$pkgs $cli_extra $gui_base $gui_extra"
		pkgs="$pkgs $dev_base $dev_mesa $dev_cross"
		pkgs="$pkgs $hw_metal $hw_xps"
		;;
	"crostini")
		pkgs="$pkgs $hw_crostini"
		;;
	*)
		echo "unknown device: $host"
		exit 1
		;;
esac

#pacman -S --needed $pkgs

qeq="$(pacman -Qeq)"
if [ -n "$qeq" ]; then
	pacman -Dq --asdeps $qeq
fi

pacman -Dq --asexplicit $pkgs
